<h2>Shopping Cart</h2>

<% if !@order_items || @order_items.empty? %>
  <p>You don't have any products in your cart!</p>

<% else %>
  <table class="table">
    <thead>
      <tr>
        <th>Image</th>
        <th>Title</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Remove</th>
      </tr>
    </thead>
    <tbody>
      <% @order_items.each do |item| %>
        <tr>
          <td><%= link_to image_tag(item.product.photo_url, height: "150", :alt => "product photo"), product_path(item.product) %></td>
          <td><%= link_to item.product.title, product_path(item.product) %></td>
          <td><%= number_to_currency(item.product.price) %></td>
          <td>
            <%= form_with model: item do |f| %>

              <%= f.label "Quantity", class: "text-hide" %>
              <%= f.select(:quantity, (1..item.product.stock).map(&:to_i)) %>

              <%= f.submit "Update" %>
              
            <% end %>
          </td>
          <td><%= link_to "Remove", order_item_path(item), class: "btn btn-danger", method: "delete", data: { confirm: "Are you sure you want to remove #{item.product.title} from your cart?" } %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <ul class="nav justify-content-center">
    <li class="nav-item">
      <%= link_to "Proceed to Checkout", order_checkout_path, class: "btn btn-primary" %>
    </li>
  </ul>
<% end %>