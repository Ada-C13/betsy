
<main class="container text-center">
<%# <div class="cart-background card bg-light"> %>
  <h1>Your Cart</h1>

  <section>
    <% if @session[:cart] != {} %>
      <%@session[:cart].each do |product| %>
        <div>
          <% @product = Product.find_by(id: product[0]) %>
          <p><b><%= link_to @product.name, product_path(@product.id) %></b></p>
          <p>Price: <%= number_to_currency(@product.price) %></b></p>
          <p><b>Quantity: <%= product[1]%></b></p>

          <%= form_with url: product_update_quant_path(@product.id), method: "patch" do |f| %>
            <div class ="form-group">
              <%= f.label :Quantity %>
              <%= f.select :quantity, [1,2,3,4,5], class:"form-control"  %>
            </div>
            <div class ="form-group">
              <%= f.submit "Update", class:"btn btn-success"%> <%# need to fix this button to link to the cart%>
            </div>  
          <% end %>

          <%= link_to "Delete",  product_remove_cart_path(@product.id), method: 'patch', class: 'btn btn-success' %>
        </div>
        <br>
      <% end %>

      <aside>
        <% subtotal = Product.subtotal(session) %>
        <% total_items = Product.cart_total_items(session) %>
        <p>Total: <%= "$#{'%.2f' % (subtotal)}" %></p>
        <p>Shipping: Free</p>
        <p>Tax: <%= "$#{'%.2f' % (subtotal*0.1)}" %></p>
        <p><b>Subtotal (<%= total_items %> <%=total_items > 1 ? "items" : "item" %>): <%= "$#{'%.2f' % (subtotal*1.1)}" %> </b></p>
        <%= link_to "Proceed to Checkout", new_order_path, class: 'btn btn-success' %>
      </aside>
    <%else%>
      <div class='empty-cart'>
        <%= image_tag "https://lh3.googleusercontent.com/pw/ACtC-3e03vkTI-6MF1447d8TuXQj4Rvr2u8TjSneFZbv3h7cXP7yVWlMq7rEfdPSleMtt_g46KaTUMgVLdhU8jYw-gE_vXlM_tD3l4v2IuooZyrP7HfwemQllR0J7eKAkrmjdJiZuhp8ABaobquMEG8gDVbCRA=w1236-h1544-no?authuser=0" %>
        <h2><b>Oh-Oh your cart is empty!</b></h2>
      </div>
    <% end %>
  </section>

  <div>
    <%= link_to "Continue shopping", products_path, class: 'btn btn-success' %>
  </div>
  <%# </div> %>
</main>

