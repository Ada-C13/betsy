<div class="product container">
  <h1><%= @product.name %></h1>
  <p><%= link_to "Back to all products", products_path, class: "products__all" %></p>
  <div class="row">
    <section class="col-8 product__image">
      <div class="">
        <% if @product.image %>
          <%= image_tag(@product.image, class: "img-fluid img_max") %>
        <% else %>
          <%= image_tag('https://www.colonialkc.org/wp-content/uploads/2015/07/Placeholder.png', class: "img-fluid") %>
        <% end %>
      </div>
    </section>

    <section class="col product__info">
      <h2><%= @product.name %></h2>
      <h3><%= @product.artist %></h3>
      <% if @product.inventory <= 3 %>
        <p class="product__limited">Limited stock!</p>
        <p>Only <%= @product.inventory %> left</p>
      <% else %>
        <p><%= @product.inventory %> available</p>
      <% end %>
      <p>Price: $<%= @product.price %></p>
      <p>Category:
      <% @product.categories.each do |category| %>
        <%= category.name %>
      <% end  %>
      <%= form_with model: @order_items, url: product_order_items_path(@product.id) do |f| %>
        <%= f.select :quantity, (1..10) %>
        <%= f.submit "ADD TO CART", class: "btn btn-custom" %>
      <%end%>
      <% if session[:merchant_id] == @product.merchant_id %>
        <p><%= link_to "Edit", edit_product_path(@product.id),class:"btn btn-primary" %></p>
        <p><%= link_to "Delete", product_path(@product.id) ,method: :delete, data: { confirm: "Are you sure you want to delete this product?"} ,class:"btn btn-danger"%></p>
      <% end %>
    </section>
  </div>
  
  <section class="row reviews">
    <div class="col-3 justify-content-between">
      <h2 class="reviews__header">Reviews</h2>
      <p>[average rating] out of 5</p>
      <%= link_to "Leave a review", new_product_review_path(@product.id), class: "btn btn-custom" %>
    </div>
    <div class="col">
      <% @product.reviews.each do |review| %>
          <p>
            <% review.rating.times do %>
              <%= image_tag("paint-palette.png", class: "img-fluid review__icon") %>
            <% end %>
          </p>
          <p>Reviewed <%= review.created_at.strftime("%b %d, %Y") %></p>
          <p><%= review.description %></p>
          <hr/>
      <% end %>
    </div>
  </section>

</div>
